version: 2
plan:
  project-key: dem2
  key: CONVERT
  name: Convert Helm to Marathon JSON
  description: Convert Helm to Marathon JSON
stages:
- Default Stage:
    manual: false
    final: false
    jobs:
    - build and convert
    - package and upload
build and convert:
  key: BC
  description: build and convert
  tasks:
  - checkout:
      force-clean-build: false
      description: Checkout Default Repository
  - script:
      interpreter: SHELL
      scripts:
      - python3 convert_helm_to_marathon.py
      description: Extract and Convert Helm to Marathon JSON
  artifact-subscriptions: []
package and upload:
  key: PU
  description: package and upload
  tasks:
  - checkout:
      force-clean-build: false
      description: Checkout Default Repository
  - script:
      interpreter: SHELL
      scripts:
      - tar -czvf ${bamboo_build_working_directory}/converted_chart.tgz -C ${bamboo_build_working_directory} marathon.json
      description: Package the Converted Files
  - script:
      interpreter: SHELL
      scripts:
      - |-
        curl -u bamboonexus:VhaG0ng51mplengpASS \
        -T ${bamboo_build_working_directory}/converted_chart.tgz \
        http://nexusdemo.climacs.net:8081/repository/bamboodemo/ \
        -v
      description: Upload to Nexus
  artifact-subscriptions: []
repositories:
- helmchart2marathon:
    type: github
    base-url: https://github.com
    repository: climacs-net/convert_helm_to_marathon
    branch: main
    user: climacs-net
    password: BAMSCRT@0@0@rtt+BMZXbSwPCc6Eo/fuNYn/LNUG1tm/vn+NZ4agk64veaJRSZdevF8zUHsID5p8
    command-timeout-minutes: '180'
    lfs: false
    verbose-logs: false
    use-shallow-clones: false
    cache-on-agents: true
    submodules: false
    ssh-key-applies-to-submodules: true
    fetch-all: false
    viewer:
      com.atlassian.bamboo.plugins.atlassian-bamboo-plugin-git:githubViewer: {}
triggers:
- polling:
    period: '180'
branches:
  create: manually
  delete: never
  link-to-jira: true
notifications: []
labels: []
dependencies:
  require-all-stages-passing: false
  enabled-for-branches: true
  block-strategy: none
  plans: []
other:
  concurrent-build-plugin: system-default
---
version: 2
plan:
  key: DEM2-CONVERT
plan-permissions:
- roles:
  - logged-in
  - anonymous
  permissions​⬤
